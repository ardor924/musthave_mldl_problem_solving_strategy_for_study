
<h1>ìì „ê±° ëŒ€ì—¬ ìˆ˜ìš”ì˜ˆì¸¡</h1>
<h2>ëª©ì°¨</h2>


- [6.3 íƒìƒ‰ì  ë°ì´í„° ë¶„ì„](#63-íƒìƒ‰ì -ë°ì´í„°-ë¶„ì„)
  - [6.3.1 ìºê¸€ ë…¸íŠ¸ë¶ í™˜ê²½ì„¤ì •](#631-ìºê¸€-ë…¸íŠ¸ë¶-í™˜ê²½ì„¤ì •)
  - [6.3.2 ë°ì´í„° ë‘˜ëŸ¬ë³´ê¸°](#632-ë°ì´í„°-ë‘˜ëŸ¬ë³´ê¸°)
  - [6.3.3 í”¼ì³ ì—”ì§€ë‹ˆì–´ë§](#633-í”¼ì³-ì—”ì§€ë‹ˆì–´ë§)
  - [6.3.4 ë°ì´í„° ì‹œê°í™”](#634-ë°ì´í„°-ì‹œê°í™”)
    - [1) ë¶„í¬ë„](#1-ë¶„í¬ë„)
    - [2) ë§‰ëŒ€ê·¸ë˜í”„](#2-ë§‰ëŒ€ê·¸ë˜í”„)
    - [3) ë°•ìŠ¤í”Œë¡¯](#3-ë°•ìŠ¤í”Œë¡¯)
    - [4) í¬ì¸íŠ¸ í”Œë¡¯](#4-í¬ì¸íŠ¸-í”Œë¡¯)
    - [5) íšŒê·€ì„ ì„í¬í•¨í•œ ì‚°ì ë„ ê·¸ë˜í”„](#5-íšŒê·€ì„ ì„í¬í•¨í•œ-ì‚°ì ë„-ê·¸ë˜í”„)
    - [6) íˆíŠ¸ë§µ](#6-íˆíŠ¸ë§µ)
  - [6.3.5 ë¶„ì„ì •ë¦¬](#635-ë¶„ì„ì •ë¦¬)
  - [6.3.6 ëª¨ë¸ë§ ì „ëµ](#636-ëª¨ë¸ë§-ì „ëµ)
- [6.4 ë² ì´ìŠ¤ë¼ì¸ ëª¨ë¸ë§](#64-ë² ì´ìŠ¤ë¼ì¸-ëª¨ë¸ë§)
  - [6.4.1 í”¼ì³ ì—”ì§€ë‹ˆì–´ë§](#641-í”¼ì³-ì—”ì§€ë‹ˆì–´ë§)
    - [0) ë°ì´í„° ë¡œë“œ](#0-ë°ì´í„°-ë¡œë“œ)
    - [1) ì´ìƒì¹˜ ì œê±°](#1-ì´ìƒì¹˜-ì œê±°)
    - [2) ë°ì´í„° í•©ì¹˜ê¸°](#2-ë°ì´í„°-í•©ì¹˜ê¸°)
    - [3) íŒŒìƒí”¼ì²˜(ë³€ìˆ˜)ì¶”ê°€](#3-íŒŒìƒí”¼ì²˜ë³€ìˆ˜ì¶”ê°€)
    - [4) í•„ìš”ì—†ëŠ” í”¼ì²˜ ì œê±°](#4-í•„ìš”ì—†ëŠ”-í”¼ì²˜-ì œê±°)
    - [5) ë°ì´í„° ë‚˜ëˆ„ê¸°](#5-ë°ì´í„°-ë‚˜ëˆ„ê¸°)
  - [6.4.2 í‰ê°€ì§€í‘œ ê³„ì‚°í•¨ìˆ˜ ì‘ì„±](#642-í‰ê°€ì§€í‘œ-ê³„ì‚°í•¨ìˆ˜-ì‘ì„±)
  - [6.4.3 ëª¨ë¸í›ˆë ¨](#643-ëª¨ë¸í›ˆë ¨)
  - [6.4.4 ëª¨ë¸ì„±ëŠ¥ ê²€ì¦](#644-ëª¨ë¸ì„±ëŠ¥-ê²€ì¦)
  - [6.4.5 ì˜ˆì¸¡ ë° ê²°ê³¼ ê²€ì¦](#645-ì˜ˆì¸¡-ë°-ê²°ê³¼-ê²€ì¦)
- [6.5 ì„±ëŠ¥ê°œì„  I (ë¦¿ì§€íšŒê·€ ëª¨ë¸)](#65-ì„±ëŠ¥ê°œì„ -i-ë¦¿ì§€íšŒê·€-ëª¨ë¸)
  - [6.5.1 í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”(ëª¨ë¸í›ˆë ¨)](#651-í•˜ì´í¼íŒŒë¼ë¯¸í„°-ìµœì í™”ëª¨ë¸í›ˆë ¨)
    - [1) ëª¨ë¸ìƒì„±](#1-ëª¨ë¸ìƒì„±)
    - [2) ê·¸ë¦¬ë“œ ì„œì¹˜ ê°ì²´ ìƒì„±](#2-ê·¸ë¦¬ë“œ-ì„œì¹˜-ê°ì²´-ìƒì„±)
    - [3) ê·¸ë¦¬ë“œ ì„œì¹˜ ìˆ˜í–‰](#3-ê·¸ë¦¬ë“œ-ì„œì¹˜-ìˆ˜í–‰)
  - [6.5.2 ì„±ëŠ¥ê²€ì¦](#652-ì„±ëŠ¥ê²€ì¦)
- [6.6 ì„±ëŠ¥ê°œì„  II  (ë¼ì˜íšŒê·€ ëª¨ë¸)](#66-ì„±ëŠ¥ê°œì„ -ii--ë¼ì˜íšŒê·€-ëª¨ë¸)
  - [6.6.1 í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”(ëª¨ë¸í›ˆë ¨)](#661-í•˜ì´í¼íŒŒë¼ë¯¸í„°-ìµœì í™”ëª¨ë¸í›ˆë ¨)
  - [6.6.2 ì„±ëŠ¥ê²€ì¦](#662-ì„±ëŠ¥ê²€ì¦)
- [6.7 ì„±ëŠ¥ê°œì„  III  (ëœë¤í¬ë ˆìŠ¤íŠ¸ íšŒê·€ ëª¨ë¸)](#67-ì„±ëŠ¥ê°œì„ -iii--ëœë¤í¬ë ˆìŠ¤íŠ¸-íšŒê·€-ëª¨ë¸)
  - [6.7.1 í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”(ëª¨ë¸í›ˆë ¨)](#671-í•˜ì´í¼íŒŒë¼ë¯¸í„°-ìµœì í™”ëª¨ë¸í›ˆë ¨)
  - [6.7.2 ì„±ëŠ¥ê²€ì¦](#672-ì„±ëŠ¥ê²€ì¦)
  - [6.7.3 ì˜ˆì¸¡ ë° ê²°ê³¼ ì œì¶œ](#673-ì˜ˆì¸¡-ë°-ê²°ê³¼-ì œì¶œ)
- [6.8 í•µì‹¬ìš”ì•½](#68-í•µì‹¬ìš”ì•½)

ğŸ”» ì±•í„°6 ì „ì²´íë¦„
<br>
<br><img src="./image/ch6_flow_chapter6.png" width="720">


## 6.3 íƒìƒ‰ì  ë°ì´í„° ë¶„ì„
ğŸ”»ë² ì´ìŠ¤ë¼ì¸ ëª¨ë¸ ì „ì²´ í”„ë¡œì„¸ìŠ¤
<br>
<br><img src="./image/ch6_Process_EDA.png" width="720">

### 6.3.1 ìºê¸€ ë…¸íŠ¸ë¶ í™˜ê²½ì„¤ì •
-------------------------------------------

ìˆ˜í–‰ì‚¬í•­ : ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¼ì¹˜í•˜ëŠ” ì‘ì—…ì„ ì‹¤í–‰

### 6.3.2 ë°ì´í„° ë‘˜ëŸ¬ë³´ê¸°
-------------------------------------------
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/ardor924/musthave_mldl_problem_solving_strategy_for_study/blob/master/base/Part2_MachineLearning/Chapter6.ipynb#632-ë°ì´í„°-ë‘˜ëŸ¬ë³´ê¸°)


```python
import numpy as np
import pandas as pd

data_path = './Chapter6_data/'

train = pd.read_csv(data_path+'train.csv')
test = pd.read_csv(data_path+'test.csv')
submission = pd.read_csv(data_path+'sampleSubmission.csv')
```
```python
display(train.head())
display(test.head())
display(submission.head())
```


<br><img src="./image/ch6_feature_img.png" width="500">

ìˆ˜í–‰ì‚¬í•­ : caual,registered,datetime í”¼ì³ì œê±°

### 6.3.3 í”¼ì³ ì—”ì§€ë‹ˆì–´ë§
-------------------------------------------
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/ardor924/musthave_mldl_problem_solving_strategy_for_study/blob/master/base/Part2_MachineLearning/Chapter6.ipynb)

ìˆ˜í–‰ì‚¬í•­ : ë‚ ì§œí”¼ì³(ì—°,ì›”,ì¼,ì‹œ,ë¶„,ì´ˆ) ì¶”ê°€

```python
train['date'] = train['datetime'].apply(lambda x: x.split()[0]) # ë‚ ì§œ í”¼ì²˜ ìƒì„±

# ì—°ë„, ì›”, ì¼, ì‹œ, ë¶„, ì´ˆ í”¼ì²˜ë¥¼ ì°¨ë¡€ë¡œ ìƒì„±
train['year'] = train['datetime'].apply(lambda x: x.split()[0].split('-')[0]) 
train['month'] = train['datetime'].apply(lambda x: x.split()[0].split('-')[1])
train['day'] = train['datetime'].apply(lambda x: x.split()[0].split('-')[2]) 
train['hour'] = train['datetime'].apply(lambda x: x.split()[1].split(':')[0])
train['minute'] = train['datetime'].apply(lambda x: x.split()[1].split(':')[1])
train['second'] = train['datetime'].apply(lambda x: x.split()[1].split(':')[2])
```


ìˆ˜í–‰ì‚¬í•­ : ìš”ì¼í”¼ì³ ì¶”ê°€
```python
from datetime import datetime # datatime ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„í¬íŠ¸
import calendar

train['weekday'] = train['date'].apply(
    lambda dateString: 
    calendar.day_name[datetime.strptime(dateString,"%Y-%m-%d").weekday()])
```

ìˆ˜í–‰ì‚¬í•­ : ê³„ì ˆ,ë‚ ì”¨ í”¼ì³ ì‚¬ìš©ê°œì„ (ë¬¸ìì—´ë¡œë³€í™˜)

```python
train['season'] = train['season'].map({1: 'Spring', 
                                       2: 'Summer', 
                                       3: 'Fall', 
                                       4: 'Winter' })
train['weather'] = train['weather'].map({1: 'Clear', 
                                         2: 'Mist, Few clouds', 
                                         3: 'Light Snow, Rain, Thunder', 
                                         4: 'Heavy Snow, Rain, Thunder'})
```

### 6.3.4 ë°ì´í„° ì‹œê°í™”
----------------------

```python
import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib as mpl
import matplotlib.pyplot as plt
%matplotlib inline

sns.set_theme(style='whitegrid')

import warnings
warnings.simplefilter(action='ignore', category=FutureWarning)
```

#### 1) ë¶„í¬ë„
-------------------------
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/ardor924/musthave_mldl_problem_solving_strategy_for_study/blob/master/base/Part2_MachineLearning/Chapter6.ipynb#1-ë¶„í¬ë„)

```python
mpl.rc('font', size=15)      # í°íŠ¸ í¬ê¸°ë¥¼ 15ë¡œ ì„¤ì • 
sns.displot(train['count']); # ë¶„í¬ë„ ì¶œë ¥
```
```python
sns.displot(np.log(train['count']));
```

ìˆ˜í–‰ì‚¬í•­ : íšŒê·€ëª¨ë¸ ì„±ëŠ¥ê°œì„ ì„ ìœ„í•œ ë¡œê·¸ë³€í™˜ì§„í–‰

<p style="color : skyblue;  font-weight:bolder">
    ì •ë¦¬ : íƒ€ê¹ƒê°’ë¶„í¬ê°€ ì •ê·œë¶„í¬ì— ê°€ê¹Œìš¸ ìˆ˜ë¡ íšŒê·€ëª¨ë¸ì˜ ì„±ëŠ¥ì´ ìƒìŠ¹í•¨
</p>    

#### 2) ë§‰ëŒ€ê·¸ë˜í”„
-------------------------
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/ardor924/musthave_mldl_problem_solving_strategy_for_study/blob/master/base/Part2_MachineLearning/Chapter6.ipynb#2-ë§‰ëŒ€ê·¸ë˜í”„)
```python
# ìŠ¤í… 1 : mí–‰ nì—´ Figure ì¤€ë¹„
mpl.rc('font', size=14)       # í°íŠ¸ í¬ê¸° ì„¤ì •
mpl.rc('axes', titlesize=15)  # ê° ì¶•ì˜ ì œëª© í¬ê¸° ì„¤ì •
figure, axes = plt.subplots(nrows=3, ncols=2) # 3í–‰ 2ì—´ Figure ìƒì„± 
plt.tight_layout()            # ê·¸ë˜í”„ ì‚¬ì´ì— ì—¬ë°± í™•ë³´ 
figure.set_size_inches(10, 9) # ì „ì²´ Figure í¬ê¸°ë¥¼ 10x9ì¸ì¹˜ë¡œ ì„¤ì • 

# ìŠ¤í… 2 : ê° ì¶•ì— ì„œë¸Œí”Œë¡¯ í• ë‹¹
# ê° ì¶•ì— ì—°ë„, ì›”, ì¼, ì‹œê°„, ë¶„, ì´ˆë³„ í‰ê·  ëŒ€ì—¬ ìˆ˜ëŸ‰ ë§‰ëŒ€ ê·¸ë˜í”„ í• ë‹¹
sns.barplot(x='year', y='count', data=train, ax=axes[0, 0])
sns.barplot(x='month', y='count', data=train, ax=axes[0, 1])
sns.barplot(x='day', y='count', data=train, ax=axes[1, 0])
sns.barplot(x='hour', y='count', data=train, ax=axes[1, 1])
sns.barplot(x='minute', y='count', data=train, ax=axes[2, 0])
sns.barplot(x='second', y='count', data=train, ax=axes[2, 1])

# ìŠ¤í… 3 : ì„¸ë¶€ ì„¤ì •
# 3-1 : ì„œë¸Œí”Œë¡¯ì— ì œëª© ë‹¬ê¸°
axes[0, 0].set(title='Rental amounts by year')
axes[0, 1].set(title='Rental amounts by month')
axes[1, 0].set(title='Rental amounts by day')
axes[1, 1].set(title='Rental amounts by hour')
axes[2, 0].set(title='Rental amounts by minute')
axes[2, 1].set(title='Rental amounts by second')

# 3-2 : 1í–‰ì— ìœ„ì¹˜í•œ ì„œë¸Œí”Œë¡¯ë“¤ì˜ xì¶• ë¼ë²¨ 90ë„ íšŒì „
axes[1, 0].tick_params(axis='x', labelrotation=90)
axes[1, 1].tick_params(axis='x', labelrotation=90)
```

ë¶„ì„ê²°ê³¼ : 
- 3ë²ˆê·¸ë˜í”„ - dayí”¼ì³ ì œê±°
- 5,6ë²ˆ ê·¸ë˜í”„ - minute,second í”¼ì³ ì œê±° 


#### 3) ë°•ìŠ¤í”Œë¡¯ 
-------------------------
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/ardor924/musthave_mldl_problem_solving_strategy_for_study/blob/master/base/Part2_MachineLearning/Chapter6.ipynb#3-ë°•ìŠ¤í”Œë¡¯)
```python
# ìŠ¤í… 1 : mí–‰ nì—´ Figure ì¤€ë¹„
figure, axes = plt.subplots(nrows=2, ncols=2) # 2í–‰ 2ì—´
plt.tight_layout()
figure.set_size_inches(10, 10)

# ìŠ¤í… 2 : ì„œë¸Œí”Œë¡¯ í• ë‹¹
# ê³„ì ˆ, ë‚ ì”¨, ê³µíœ´ì¼, ê·¼ë¬´ì¼ë³„ ëŒ€ì—¬ ìˆ˜ëŸ‰ ë°•ìŠ¤í”Œë¡¯
sns.boxplot(x='season', y='count', data=train, ax=axes[0, 0])
sns.boxplot(x='weather', y='count', data=train, ax=axes[0, 1])
sns.boxplot(x='holiday', y='count', data=train, ax=axes[1, 0])
sns.boxplot(x='workingday', y='count', data=train, ax=axes[1, 1])

# ìŠ¤í… 3 : ì„¸ë¶€ ì„¤ì •
# 3-1 : ì„œë¸Œí”Œë¡¯ì— ì œëª© ë‹¬ê¸°
axes[0, 0].set(title='Box Plot On Count Across Season')
axes[0, 1].set(title='Box Plot On Count Across Weather')
axes[1, 0].set(title='Box Plot On Count Across Holiday')
axes[1, 1].set(title='Box Plot On Count Across Working Day')

# 3-2 : xì¶• ë¼ë²¨ ê²¹ì¹¨ í•´ê²°
axes[0, 1].tick_params('x', labelrotation=10) # 10ë„ íšŒì „
```


#### 4) í¬ì¸íŠ¸ í”Œë¡¯
-------------------------
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/ardor924/musthave_mldl_problem_solving_strategy_for_study/blob/master/base/Part2_MachineLearning/Chapter6.ipynb#4-í¬ì¸íŠ¸-í”Œë¡¯)

```python
# ìŠ¤í… 1 : mí–‰ nì—´ Figure ì¤€ë¹„
mpl.rc('font', size=11)
figure, axes = plt.subplots(nrows=5) # 5í–‰ 1ì—´
figure.set_size_inches(12, 18)

# ìŠ¤í… 2 : ì„œë¸Œí”Œë¡¯ í• ë‹¹
# ê·¼ë¬´ì¼, ê³µíœ´ì¼, ìš”ì¼, ê³„ì ˆ, ë‚ ì”¨ì— ë”°ë¥¸ ì‹œê°„ëŒ€ë³„ í‰ê·  ëŒ€ì—¬ ìˆ˜ëŸ‰ í¬ì¸íŠ¸í”Œë¡¯
sns.pointplot(x='hour', y='count', data=train, hue='workingday', ax=axes[0])
sns.pointplot(x='hour', y='count', data=train, hue='holiday', ax=axes[1])
sns.pointplot(x='hour', y='count', data=train, hue='weekday', ax=axes[2])
sns.pointplot(x='hour', y='count', data=train, hue='season', ax=axes[3])
sns.pointplot(x='hour', y='count', data=train, hue='weather', ax=axes[4]);

```

ë¶„ì„ê²°ê³¼ : 
-  5ë²ˆ ê·¸ë˜í”„ì˜ whetherê°€ 4ì¸ Heavy Snow,Rain,Thunderë“±ì˜ ì´ìƒì¹˜ ë°œê²¬
-  ì„±ëŠ¥ ê°œì„ ì„ ìœ„í•´ ì´ìƒì¹˜ê°€ ìˆëŠ” ë°ì´í„°ë¥¼ ì œê±°


#### 5) íšŒê·€ì„ ì„í¬í•¨í•œ ì‚°ì ë„ ê·¸ë˜í”„
-------------------------
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/ardor924/musthave_mldl_problem_solving_strategy_for_study/blob/master/base/Part2_MachineLearning/Chapter6.ipynb#5-íšŒê·€ì„ ì„í¬í•¨í•œ-ì‚°ì ë„-ê·¸ë˜í”„)

```python
# ìŠ¤í… 1 : mí–‰ nì—´ Figure ì¤€ë¹„
mpl.rc('font', size=15)
figure, axes = plt.subplots(nrows=2, ncols=2) # 2í–‰ 2ì—´
plt.tight_layout()
figure.set_size_inches(7, 6)

# ìŠ¤í… 2 : ì„œë¸Œí”Œë¡¯ í• ë‹¹
# ì˜¨ë„, ì²´ê° ì˜¨ë„, í’ì†, ìŠµë„ ë³„ ëŒ€ì—¬ ìˆ˜ëŸ‰ ì‚°ì ë„ ê·¸ë˜í”„
sns.regplot(x='temp', y='count', data=train, ax=axes[0, 0], 
            scatter_kws={'alpha': 0.2}, line_kws={'color': 'blue'})
sns.regplot(x='atemp', y='count', data=train, ax=axes[0, 1], 
            scatter_kws={'alpha': 0.2}, line_kws={'color': 'blue'})
sns.regplot(x='windspeed', y='count', data=train, ax=axes[1, 0], 
            scatter_kws={'alpha': 0.2}, line_kws={'color': 'blue'})
sns.regplot(x='humidity', y='count', data=train, ax=axes[1, 1], 
            scatter_kws={'alpha': 0.2}, line_kws={'color': 'blue'});
```

ë¶„ì„ê²°ê³¼ : 
-  3ë²ˆ ê·¸ë˜í”„ì˜ ë°”ëŒì´ ê°•í• ìˆ˜ë¡ ëŒ€ì—¬ìˆ˜ê°€ ë§ìŒ (ë­”ê°€ ì´ìƒí•¨)
-  ì•Œê³ ë³´ë‹ˆ windspeedì— ê²°ì¸¡ì¹˜ê°€ ë§ìŒ
-  windspeed ì»¬ëŸ¼(í”¼ì³) ì œê±°

#### 6) íˆíŠ¸ë§µ
-------------------------
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/ardor924/musthave_mldl_problem_solving_strategy_for_study/blob/master/base/Part2_MachineLearning/Chapter6.ipynb#6-íˆíŠ¸ë§µ)

ìˆ˜í–‰ì‚¬í•­ : ìˆ˜ì¹˜í˜• ë°ì´í„°ì˜ í”¼ì³ê°„ ìƒê´€ê³„ìˆ˜ë¥¼ ê³„ì‚°

```python
train[['temp', 'atemp', 'humidity', 'windspeed', 'count']].corr()
```

```python
# í”¼ì²˜ ê°„ ìƒê´€ê´€ê³„ ë§¤íŠ¸ë¦­ìŠ¤
corrMat = train[['temp', 'atemp', 'humidity', 'windspeed', 'count']].corr() 
fig, ax= plt.subplots() 
fig.set_size_inches(10, 10)
sns.heatmap(corrMat, annot=True) # ìƒê´€ê´€ê³„ íˆíŠ¸ë§µ ê·¸ë¦¬ê¸°
ax.set(title='Heatmap of Numerical Data');
```

ë¶„ì„ê²°ê³¼ : 
- windspeed ì™€ count ì˜ ìƒê´€ê´€ê³„ê°€ ë§¤ìš° ì•½í•¨.
- ì„±ëŠ¥ê°œì„ ì„ ìœ„í•´ windspeedì»¬ëŸ¼(í”¼ì³) ì œê±°


### 6.3.5 ë¶„ì„ì •ë¦¬
----------------------


<br><img src="./image/ch6_help_img.png" width="720">

<section>
    <legend style="color : skyblue;  font-weight:bolder">
        1. íƒ€ê¹ƒê°’ ë³€í™˜
    </legend>    
    <p>
        ğŸŸ© ì •ê·œë¶„í¬ì— ê°€ê¹ê²Œ ì²˜ë¦¬
        <br> ğŸ”¸ countë¥¼ ë¡œê·¸ë³€í™˜(ë¶„í¬ë„ í™•ì¸ê²°ê³¼ íƒ€ê¹ƒê°’ì¸ count ê°€ 0ê·¼ì²˜ë¡œ ì¹˜ìš°ì³ ìˆìœ¼ë¯€ë¡œ)
        <br> ğŸ”¸ ë§ˆì§€ë§‰ì—ëŠ” ë‹¤ì‹œ ì§€ìˆ˜ ë³€í™˜í•˜ì—¬ ê¸°ì¡´ì˜ countë¡œ ë³µì›
    </p>
</section>

<section>
    <legend style="color : gold;  font-weight:bolder">
       2. íŒŒìƒí”¼ì³ ì¶”ê°€
    </legend>    
    <p>
        ğŸŸ© ì—¬ëŸ¬ ì •ë³´ì˜ í˜¼í•©ì²´ ë¶„í•´í›„ ì»¬ëŸ¼(í”¼ì³)ì¶”ê°€
        <br> ğŸ”¸ ì—¬ê¸°ì„  datetimeì„ ë¶„í•´
        <br> ğŸ”¸ datetimeì—ì„œ year,month,day,hour,minute,secondë¥¼ ì¶”ê°€
        <br> ğŸ”¸ ìš”ì¼(weekday)í”¼ì³ ì¶”ê°€
    </p>
</section>

<section>
    <legend style="color : crimson;  font-weight:bolder">
        3. í”¼ì³ì œê±°
    </legend>    
    <p>
        ğŸŸ© ì˜ë¯¸ì—†ëŠ” í”¼ì³ ì œê±°
        <br> ğŸ”¸ casual,registered í”¼ì³ì œê±°(test.csvì— ì—†ëŠ” ì»¬ëŸ¼)
        <br> ğŸ”¸ datetime í”¼ì³ì œê±°(indexì—­í• ë§Œ í•˜ë¯€ë¡œ í•„ìš”ì—†ìŒ)        
        <br> ğŸ”¸ date í”¼ì³ ì œê±°(year,month,dayí”¼ì³ì™€ ë‚´ìš©ì´ ê°™ìœ¼ë¯€ë¡œ êµ³ì´ í•„ìš” ì—†ìŒ )
        <br> ğŸ”¸ month í”¼ì³ì œê±°(seasonì˜ ì„¸ë¶€í•­ëª©ìœ¼ë¡œë„ í™•ì¸ê°€ëŠ¥)
        <br> ğŸ”¸ month í”¼ì³ì œê±°(seasonì˜ ì„¸ë¶€ë¶„ë¥˜ë¡œë„ í™•ì¸ê°€ëŠ¥)
        <br> ğŸ”¸ day í”¼ì³ì œê±°(ë§‰ëŒ€ê·¸ë˜í”„ í™•ì¸ê²°ê³¼ ì“¸ëª¨ì—†ìŒì´ í™•ì¸ë¨)
        <br> ğŸ”¸ minute,second í”¼ì³ì œê±°(ë§‰ëŒ€ê·¸ë˜í”„ í™•ì¸ê²°ê³¼ ì•„ë¬´ëŸ° ì •ë³´ë„ ë‹´ê²¨ìˆì§€ ì•Šì•˜ìŒ)
        <br> ğŸ”¸ windspeed í”¼ì³ì œê±°(ì‚°ì ë„ì™€ íˆíŠ¸ë§µ í™•ì¸ê²°ê³¼ windspeed í”¼ì³ëŠ” ê²°ì¸¡ê°’ì´ ë§ê³ , countì™€ ìƒê´€ê´€ê³„ê°€ ë§¤ìš° ë‚®ì•˜ìŒì„ í™•ì¸í•¨)
    </p>
</section>

<section>
    <legend style="color : mediumspringgreen;  font-weight:bolder">
        4. ì´ìƒì¹˜ ì œê±°
    </legend>    
    <p>
        whetherê°€ 4ì¸ ë°ì´í„°ëŠ” íŠ¹ìˆ˜í•œ ë‚ ì”¨ì„ê³¼ ë™ì‹œì— ì´ìƒì¹˜ë¡œ íŒë‹¨í• ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì»¬ëŸ¼(í”¼ì³)ì œê±°
</section>


### 6.3.6 ëª¨ë¸ë§ ì „ëµ
----------------------


* ë² ì´ìŠ¤ë¼ì¸ ëª¨ë¸ : LinearRegression
<p>

* ì„±ëŠ¥ê°œì„ 
    + í”¼ì³ì—”ì§€ë‹ˆì–´ë§
    + í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”
<p>

* ê¸°íƒ€  : íƒ€ê¹ƒê°’ì´ countê°€ ì•„ë‹Œ log(count)
<p>    


## 6.4 ë² ì´ìŠ¤ë¼ì¸ ëª¨ë¸ë§
----------------------

ë² ì´ìŠ¤ë¼ì¸ëª¨ë¸ : ì‚¬ì´í‚¥ëŸ°ì—ì„œ ì œê³µë˜ëŠ” ê¸°ë³¸ ì„ í˜•íšŒê·€ëª¨ë¸ ì‚¬ìš©

ğŸ”»ë² ì´ìŠ¤ë¼ì¸ ëª¨ë¸ ì „ì²´ í”„ë¡œì„¸ìŠ¤
<br>
<br><img src="./image/ch6_process_baseline-modeling.png" width="720">


### 6.4.1 í”¼ì³ ì—”ì§€ë‹ˆì–´ë§
----------------------

#### 0) ë°ì´í„° ë¡œë“œ

```python
import numpy as np
import pandas as pd

data_path = './Chapter6_data/'

train = pd.read_csv(data_path+'train.csv')
test = pd.read_csv(data_path+'test.csv')
submission = pd.read_csv(data_path+'sampleSubmission.csv')
```


#### 1) ì´ìƒì¹˜ ì œê±°
----------------------
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/ardor924/musthave_mldl_problem_solving_strategy_for_study/blob/master/base/Part2_MachineLearning/Chapter6.ipynb#1-ì´ìƒì¹˜-ì œê±°)

```python
# í›ˆë ¨ ë°ì´í„°ì—ì„œ weatherê°€ 4ê°€ ì•„ë‹Œ ë°ì´í„°ë§Œ ì¶”ì¶œ
train = train[train['weather'] != 4]
```

#### 2) ë°ì´í„° í•©ì¹˜ê¸°
----------------------
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/ardor924/musthave_mldl_problem_solving_strategy_for_study/blob/master/base/Part2_MachineLearning/Chapter6.ipynb#2-ë°ì´í„°-í•©ì¹˜ê¸°)
```python
all_data_temp = pd.concat([train, test])
all_data_temp
```

```python
all_data = pd.concat([train, test], ignore_index=True)
all_data
```


#### 3) íŒŒìƒí”¼ì²˜(ë³€ìˆ˜)ì¶”ê°€
----------------------
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/ardor924/musthave_mldl_problem_solving_strategy_for_study/blob/master/base/Part2_MachineLearning/Chapter6.ipynb#3-íŒŒìƒí”¼ì²˜(ë³€ìˆ˜)ì¶”ê°€)

```python
from datetime import datetime

# ë‚ ì§œ í”¼ì²˜ ìƒì„±
all_data['date'] = all_data['datetime'].apply(lambda x: x.split()[0])
# ì—°ë„ í”¼ì²˜ ìƒì„±
all_data['year'] = all_data['datetime'].apply(lambda x: x.split()[0].split('-')[0])
# ì›” í”¼ì²˜ ìƒì„±
all_data['month'] = all_data['datetime'].apply(lambda x: x.split()[0].split('-')[1])
# ì‹œ í”¼ì²˜ ìƒì„±
all_data['hour'] = all_data['datetime'].apply(lambda x: x.split()[1].split(':')[0])
# ìš”ì¼ í”¼ì²˜ ìƒì„±
all_data["weekday"] = all_data['date'].apply(lambda dateString : datetime.strptime(dateString,"%Y-%m-%d").weekday())
```

#### 4) í•„ìš”ì—†ëŠ” í”¼ì²˜ ì œê±°
----------------------
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/ardor924/musthave_mldl_problem_solving_strategy_for_study/blob/master/base/Part2_MachineLearning/Chapter6.ipynb#4-í•„ìš”ì—†ëŠ”-í”¼ì²˜-ì œê±°)

```python
drop_features = ['casual', 'registered', 'datetime', 'date', 'month', 'windspeed']

all_data = all_data.drop(drop_features, axis=1)
```

#### 5) ë°ì´í„° ë‚˜ëˆ„ê¸°
----------------------
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/ardor924/musthave_mldl_problem_solving_strategy_for_study/blob/master/base/Part2_MachineLearning/Chapter6.ipynb#5-ë°ì´í„°-ë‚˜ëˆ„ê¸°)

```python
# í›ˆë ¨ ë°ì´í„°ì™€ í…ŒìŠ¤íŠ¸ ë°ì´í„° ë‚˜ëˆ„ê¸°
X_train = all_data[~pd.isnull(all_data['count'])]
X_test = all_data[pd.isnull(all_data['count'])]

# íƒ€ê¹ƒê°’ count ì œê±°
X_train = X_train.drop(['count'], axis=1)
X_test = X_test.drop(['count'], axis=1)

y = train['count'] # íƒ€ê¹ƒê°’
```

ê²°ê³¼

```python
X_train.head()
```

### 6.4.2 í‰ê°€ì§€í‘œ ê³„ì‚°í•¨ìˆ˜ ì‘ì„±
----------------------

í‰ê°€ì§€í‘œ : RMSLE ì‚¬ìš©

```python
import numpy as np

def rmsle(y_true, y_pred, convertExp=True):
    # ì§€ìˆ˜ë³€í™˜
    if convertExp:
        y_true = np.exp(y_true)
        y_pred = np.exp(y_pred)
        
    # ë¡œê·¸ë³€í™˜ í›„ ê²°ì¸¡ê°’ì„ 0ìœ¼ë¡œ ë³€í™˜
    log_true = np.nan_to_num(np.log(y_true+1))
    log_pred = np.nan_to_num(np.log(y_pred+1))
    
    # RMSLE ê³„ì‚°
    output = np.sqrt(np.mean((log_true - log_pred)**2))
    return output

```

### 6.4.3 ëª¨ë¸í›ˆë ¨
----------------------

ëª¨ë¸ìƒì„±

```python
from sklearn.linear_model import LinearRegression
linear_reg_model = LinearRegression()
```

ëª¨ë¸í›ˆë ¨

```python
log_y = np.log(y)  # íƒ€ê¹ƒê°’ ë¡œê·¸ë³€í™˜
linear_reg_model.fit(X_train, log_y) # ëª¨ë¸ í›ˆë ¨
```

ì„ í˜•íšŒê·€ ì •ë¦¬ : 
- í›ˆë ¨ : í”¼ì³(ë…ë¦½ë³€ìˆ˜) ì™€ íƒ€ê¹ƒê°’(ì¢…ì†ë³€ìˆ˜)ì´ ì£¼ì–´ì§ˆë•Œ ìµœì ì˜ ê°€ì¤‘ì¹˜(ê³„ìˆ˜)ë¥¼ ì°¾ëŠ”ê²ƒ
- ì˜ˆì¸¡ : ìµœì ì˜ ê°€ì¤‘ì¹˜ë¥¼ ì•Œê³ ìˆëŠ” ìƒíƒœì—ì„œ ìƒˆë¡œìš´ ë…ë¦½ë³€ìˆ˜(ë°ì´í„°)ê°€ ì£¼ì–´ì¡Œì„ë•Œ(ì˜ˆë¥¼ë“¤ì–´ ë‚ ì§œë¥¼ ë¯¸ë˜ë¡œ ë°”ê¾¸ê³  ì˜ˆì¸¡) íƒ€ê¹ƒê°’(ì¢…ì†ë³€ìˆ˜)ë¥¼ ì¶”ì •í•˜ëŠ” ê³¼ì •

### 6.4.4 ëª¨ë¸ì„±ëŠ¥ ê²€ì¦
----------------------
```python
preds = linear_reg_model.predict(X_train)
```

```python
print (f'ì„ í˜•íšŒê·€ì˜ RMSLE ê°’ : {rmsle(log_y, preds, True):.4f}')
```


### 6.4.5 ì˜ˆì¸¡ ë° ê²°ê³¼ ê²€ì¦
----------------------

ë² ì´ìŠ¤ë¼ì¸ ì˜ˆì¸¡ê²°ê³¼ ì œì¶œì‹œ ì£¼ì˜ì‚¬í•­

1. í…ŒìŠ¤íŠ¸ë°ì´í„°ë¡œ ì˜ˆì¸¡ê²°ê³¼ ì´ìš©
2. ì˜ˆì¸¡ê°’ countì— ì§€ìˆ˜ë³€í™˜ í•„ìš” log(count) -> count

```python
linearreg_preds = linear_reg_model.predict(X_test) # í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ ì˜ˆì¸¡

submission['count'] = np.exp(linearreg_preds)    # ì§€ìˆ˜ë³€í™˜
submission.to_csv('submission.csv', index=False) # íŒŒì¼ë¡œ ì €ì¥
```

```python
submission.head()
```

## 6.5 ì„±ëŠ¥ê°œì„  I (ë¦¿ì§€íšŒê·€ ëª¨ë¸)

ë¦¿ì§€íšŒê·€ ëª¨ë¸ :  `L2 ê·œì œ`ë¥¼ ì ìš©í•œ ì„ í˜•íšŒê·€ëª¨ë¸
<br>
ê·œì œ : ëª¨ë¸ì´ í›ˆë ¨ë°ì´í„°ë¥¼ ê³¼ëŒ€ì í•© í•˜ì§€ ì•Šê²Œ í•´ì£¼ëŠ” ë°©ë²•
<br>

<span style="color:green; font-weight:bold">ì¥ì   : ë‹¨ìˆœ ë² ì´ìŠ¤ëª¨ë¸ ë³´ë‹¤ëŠ” ê³¼ëŒ€ì í•©ì´ ì ë‹¤.<span>
<br>
<span style="color:crimson; font-weight:bold">ë‹¨ì   : ì„±ëŠ¥ì´ êµ¬ë¦¬ë‹¤.<span>

ğŸ”»ë² ì´ìŠ¤ë¼ì¸ ëª¨ë¸ ê³¼ ëª¨ë¸ì„±ëŠ¥ ê°œì„  í”„ë¡œì„¸ìŠ¤ ë¹„êµ
<br>
<br><img src="./image/ch6_compare_to_baseline_with_sklearn.png" width="720">

### 6.5.1 í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”(ëª¨ë¸í›ˆë ¨)
----------------------

ìµœì í™” ë°©ë²• : ê·¸ë¦¬ë“œ ì„œì¹˜ ê¸°ë²• ì‚¬ìš©

#### 1) ëª¨ë¸ìƒì„±
----------------------------------

```python
from sklearn.linear_model import Ridge
from sklearn.model_selection import GridSearchCV
from sklearn import metrics
ridge_model = Ridge()
```

#### 2) ê·¸ë¦¬ë“œ ì„œì¹˜ ê°ì²´ ìƒì„±
----------------------------------

```python
# í•˜ì´í¼ íŒŒë¼ë¯¸í„° ê°’ ëª©ë¡
ridge_params = {'max_iter':[3000], 'alpha':[0.1, 1, 2, 3, 4, 10, 30, 100, 200, 300, 400, 800, 900, 1000]}

# êµì°¨ ê²€ì¦ìš© í‰ê°€ í•¨ìˆ˜(RMSLE ì ìˆ˜ ê³„ì‚°)
rmsle_scorer = metrics.make_scorer(rmsle, greater_is_better=False)
# ê·¸ë¦¬ë“œì„œì¹˜(with ë¦¿ì§€) ê°ì²´ ìƒì„±
gridsearch_ridge_model = GridSearchCV(estimator=ridge_model,   # ë¦¿ì§€ ëª¨ë¸
                                      param_grid=ridge_params, # ê°’ ëª©ë¡
                                      scoring=rmsle_scorer,    # í‰ê°€ì§€í‘œ
                                      cv=5)                    # êµì°¨ê²€ì¦ ë¶„í•  ìˆ˜

```

#### 3) ê·¸ë¦¬ë“œ ì„œì¹˜ ìˆ˜í–‰
----------------------------------

```python
log_y = np.log(y) # íƒ€ê¹ƒê°’ ë¡œê·¸ë³€í™˜
gridsearch_ridge_model.fit(X_train, log_y) # í›ˆë ¨(ê·¸ë¦¬ë“œì„œì¹˜)
```

```python
print('ìµœì  í•˜ì´í¼íŒŒë¼ë¯¸í„° :', gridsearch_ridge_model.best_params_)
```
>ìµœì  í•˜ì´í¼íŒŒë¼ë¯¸í„° : {'alpha': 0.1, 'max_iter': 3000}


### 6.5.2 ì„±ëŠ¥ê²€ì¦
----------------------
```python
# ì˜ˆì¸¡
preds = gridsearch_ridge_model.best_estimator_.predict(X_train) 

# í‰ê°€
print(f'ë¦¿ì§€ íšŒê·€ RMSLE ê°’ : {rmsle(log_y, preds, True):.4f}') 
```
>ë¦¿ì§€ íšŒê·€ RMSLE ê°’ : 1.0205


<p style="color:green;font-weight:bolder">ê²°ë¡  : ë¦¿ì§€íšŒê·€ ëª¨ë¸ì˜ RMSLEëŠ” 1.0205ë¡œ, ì¼ë°˜ ì„ í˜•íšŒê·€ ëª¨ë¸ì˜ RMSLEì™€ ì„±ëŠ¥ì˜ ì°¨ì´ê°€ ì—†ë‹¤.</p>
<p style="color:cyan;font-weight:bolder">ë¦¬ë·° : ë¦¿ì§€íšŒê·€ ëª¨ë¸ ì„±ëŠ¥ ë‚˜ì˜ë‹¤.</p>

~~ì´ê±¸ êµ³ì´ ì‚¬ìš©í•  í•„ìš”ëŠ” ì—†ì„ë“¯?~~


## 6.6 ì„±ëŠ¥ê°œì„  II  (ë¼ì˜íšŒê·€ ëª¨ë¸)

ë¼ì˜íšŒê·€ ëª¨ë¸ :  ì´ê²ƒë„ `L2 ê·œì œ`ë¥¼ ì ìš©í•œ ì„ í˜•íšŒê·€ëª¨ë¸
<br>
ê·œì œ : ëª¨ë¸ì´ í›ˆë ¨ë°ì´í„°ë¥¼ ê³¼ëŒ€ì í•© í•˜ì§€ ì•Šê²Œ í•´ì£¼ëŠ” ë°©ë²•
<br>

<span style="color:green; font-weight:bold">ì¥ì   : ë‹¨ìˆœ ë² ì´ìŠ¤ëª¨ë¸ ë³´ë‹¤ëŠ” ê³¼ëŒ€ì í•©ì´ ì ë‹¤.<span>
<br>
<span style="color:crimson; font-weight:bold">ë‹¨ì   : ì„±ëŠ¥ì´ êµ¬ë¦¬ë‹¤.<span>
<br>
<span style="color:yellow; font-weight:bold">ì£¼ì˜  : ëª¨ë¸ ë§Œë“¤ê±°ë©´, ì ì–´ë„ ë¦¿ì§€ë‚˜ ë¼ì˜ë³´ë‹¤ëŠ” ì„±ëŠ¥ì´ ë‚˜ì™€ì•¼ í•œë‹¤.<span>

### 6.6.1 í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”(ëª¨ë¸í›ˆë ¨)
----------------------

```python
from sklearn.linear_model import Lasso

# ëª¨ë¸ ìƒì„±
lasso_model = Lasso()
# í•˜ì´í¼íŒŒë¼ë¯¸í„° ê°’ ëª©ë¡
lasso_alpha = 1/np.array([0.1, 1, 2, 3, 4, 10, 30, 100, 200, 300, 400, 800, 900, 1000])
lasso_params = {'max_iter':[3000], 'alpha':lasso_alpha}
# ê·¸ë¦¬ë“œì„œì¹˜(with ë¼ì˜) ê°ì²´ ìƒì„±
gridsearch_lasso_model = GridSearchCV(estimator=lasso_model,
                                      param_grid=lasso_params,
                                      scoring=rmsle_scorer,
                                      cv=5)
# ê·¸ë¦¬ë“œì„œì¹˜ ìˆ˜í–‰
log_y = np.log(y)
gridsearch_lasso_model.fit(X_train, log_y)

print('ìµœì  í•˜ì´í¼íŒŒë¼ë¯¸í„° :', gridsearch_lasso_model.best_params_)
```
>ìµœì  í•˜ì´í¼íŒŒë¼ë¯¸í„° : {'alpha': 0.00125, 'max_iter': 3000}


### 6.6.2 ì„±ëŠ¥ê²€ì¦
----------------------

```python
# ì˜ˆì¸¡
preds = gridsearch_lasso_model.best_estimator_.predict(X_train)

# í‰ê°€
print(f'ë¼ì˜ íšŒê·€ RMSLE ê°’ : {rmsle(log_y, preds, True):.4f}')

```

>ë¼ì˜ íšŒê·€ RMSLE ê°’ : 1.0205

<p style="color:green;font-weight:bolder">ê²°ë¡  : ë¼ì˜ ëª¨ë¸ì˜ RMSLEëŠ” 1.0205ë¡œ, ì¼ë°˜ ì„ í˜•íšŒê·€ ëª¨ë¸ì˜ RMSLEì™€ ì„±ëŠ¥ì˜ ì°¨ì´ê°€ ì—†ë‹¤.</p>
<p style="color:cyan;font-weight:bolder">ë¦¬ë·° : ë¼ì˜íšŒê·€ ëª¨ë¸ë„ ì—­ì‹œ ì„±ëŠ¥ì´ ë‚˜ì˜ê¸°ëŠ” ë§ˆì°¬ê°€ì§€ì´ë‹¤.</p>

~~ë¦¿ì§€ë‚˜ ë¼ì˜ë‚˜ í•˜ë‚˜ê°™ì´ ì„±ëŠ¥ì´.... ì´ê²ƒë„ êµ³ì´ ì‚¬ìš©í•  ì¼ì´ ì—†ì„ë“¯?~~


## 6.7 ì„±ëŠ¥ê°œì„  III  (ëœë¤í¬ë ˆìŠ¤íŠ¸ íšŒê·€ ëª¨ë¸)

ëœë¤ í¬ë ˆìŠ¤íŠ¸ íšŒê·€ëª¨ë¸ :  ëœë¤í•˜ê²Œ ìƒ˜í”Œë§í•œ ëª¨ë¸ nê°œë¥¼ ê°ê° í›ˆë ¨í•˜ì—¬ ê²°ê³¼ë¥¼ í‰ê· í•˜ëŠ” ë°©ë²•
<br>

<span style="color:green; font-weight:bold">ì¥ì   : ë² ì´ìŠ¤ë¼ì¸,ë¦¿ì§€ ë¼ì˜ë³´ë‹¤ RMSLE ì ìˆ˜ê°€ ì›”ë“±íˆ ì¢‹ë‹¤(ê°’ì´ ë‚®ì„ìˆ˜ë¡ ì„±ëŠ¥ì´ ì¢‹ìŒ)<span>
<br>
<span style="color:crimson; font-weight:bold">ë‹¨ì   : ì•ì˜ ë² ì´ìŠ¤ë¼ì¸, ë¦¿ì§€,ë¼ì˜ ë³´ë‹¤ ê·¸ë¦¬ë“œ ì„œì¹˜ì‹œ ì‹œê°„ì´ ì˜¤ë˜ê±¸ë¦°ë‹¤. (1ë¶„40ì´ˆì¯¤ ê±¸ë¦¼)<span>
<br>

### 6.7.1 í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”(ëª¨ë¸í›ˆë ¨)
----------------------

```python
from sklearn.ensemble import RandomForestRegressor

# ëª¨ë¸ ìƒì„±
randomforest_model = RandomForestRegressor()
# ê·¸ë¦¬ë“œì„œì¹˜ ê°ì²´ ìƒì„±
rf_params = {'random_state':[42], 'n_estimators':[100, 120, 140]}
gridsearch_random_forest_model = GridSearchCV(estimator=randomforest_model,
                                              param_grid=rf_params,
                                              scoring=rmsle_scorer,
                                              cv=5)
# ê·¸ë¦¬ë“œì„œì¹˜ ìˆ˜í–‰
log_y = np.log(y)
gridsearch_random_forest_model.fit(X_train, log_y)

print('ìµœì  í•˜ì´í¼íŒŒë¼ë¯¸í„° :', gridsearch_random_forest_model.best_params_)

```
>ìµœì  í•˜ì´í¼íŒŒë¼ë¯¸í„° : {'n_estimators': 140, 'random_state': 42}

### 6.7.2 ì„±ëŠ¥ê²€ì¦
----------------------

```python
# ì˜ˆì¸¡
preds = gridsearch_random_forest_model.best_estimator_.predict(X_train)

# í‰ê°€
print(f'ëœë¤ í¬ë ˆìŠ¤íŠ¸ íšŒê·€ RMSLE ê°’ : {rmsle(log_y, preds, True):.4f}')

```
>ëœë¤ í¬ë ˆìŠ¤íŠ¸ íšŒê·€ RMSLE ê°’ : 0.1127

<p style="color:green;font-weight:bolder">ê²°ë¡  : ëœë¤í¬ë ˆìŠ¤íŠ¸ì˜ RMSLEëŠ” 0.1126ìœ¼ë¡œ, ì¼ë°˜ ì„ í˜•íšŒê·€ ëª¨ë¸ì˜ RMSLE(1.0205)ë³´ë‹¤ ì„±ëŠ¥ì´ ìš°ìˆ˜í•˜ë‹¤.</p>
<p style="color:cyan;font-weight:bolder">ë¦¬ë·° : ë² ì´ìŠ¤ë¼ì¸,ë¦¿ì§€,ë¼ì˜,ëœë¤í¬ë ˆìŠ¤íŠ¸ ë„¤ê°œì˜ ëª¨ë¸ì¤‘ì—ì„œ ë¼ë©´ ì„±ëŠ¥ì´ íƒ‘ì´ë‹¤.</p>


### 6.7.3 ì˜ˆì¸¡ ë° ê²°ê³¼ ì œì¶œ
----------------------
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/ardor924/musthave_mldl_problem_solving_strategy_for_study/blob/master/base/Part2_MachineLearning/Chapter6.ipynb###673-ì˜ˆì¸¡-ë°-ê²°ê³¼-ì œì¶œ)
```python
import seaborn as sns
import matplotlib.pyplot as plt

randomforest_preds = gridsearch_random_forest_model.best_estimator_.predict(X_test)

figure, axes = plt.subplots(ncols=2)
figure.set_size_inches(10, 4)

sns.histplot(y, bins=50, ax=axes[0])
axes[0].set_title('Train Data Distribution')
sns.histplot(np.exp(randomforest_preds), bins=50, ax=axes[1])
axes[1].set_title('Predicted Test Data Distribution');
```

ìœ„ ê·¸ë˜í”„ë¥¼ ë³´ë©´ í›ˆë ¨ ë°ì´í„° íƒ€ê¹ƒê°’ê³¼ í…ŒìŠ¤íŠ¸ë°ì´í„° íƒ€ê¹ƒê°’ì˜ ë°ì´í„° ë¶„í¬ê°€ ë¹„ìŠ·í•œê²ƒì„ í™•ì¸ í• ìˆ˜ ìˆìŒ

```python
#ì˜ˆì¸¡ê²°ê³¼ ì €ì¥
submission['count'] = np.exp(randomforest_preds) # ì§€ìˆ˜ë³€í™˜( ì§€ê¸ˆê¹Œì§€ log(count)ì˜€ìœ¼ë¯€ë¡œ ì›ë˜ëŒ€ë¡œ countë¡œ ë³µêµ¬ì‹œí‚´ )
submission.to_csv('./Chapter6_data/submission.csv', index=False)
```

## 6.8 í•µì‹¬ìš”ì•½

1 ë¨¸ì‹ ëŸ¬ë‹ í”„ë¡œì„¸ìŠ¤
<br>
<br><img src="./image/ch6_ë¨¸ì‹ ëŸ¬ë‹íë¦„ë„.png" width="720">
+ ë¬¸ì œì´í•´ : ë¬¸ì œìœ í˜•ì„ íŒŒì•…í•˜ê³  í‰ê°€ì§€í‘œë¥¼ í™•ì¸
+ íƒìƒ‰ì  ë°ì´í„°ë¶„ì„ : ë°ì´í„° ì‹œê°í™”ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ë¶„ì„í•œí›„, í”¼ì²˜ì—”ì§€ë‹ˆì–´ë§ê³¼ ëª¨ë¸ë§ ì „ëµì„ ìˆ˜ë¦½
+ ê¸°ë³¸ëª¨ë¸ì œì‘ : ë¬¸ì œí•´ê²°ì— ì í•©í•œ ëª¨ë¸ì„ ìƒì„±, ìœ ì‚¬í•œ ë¬¸ì œë¥¼ í’€ë•Œ ì—…ê³„ì—ì„œ í”íˆ ì“°ëŠ” ëª¨ë¸ì´ë‚˜ ì§ê´€ì ìœ¼ë¡œ ë– ì˜¤ë¥´ëŠ” ëª¨ë¸ì„ ì„ íƒ
+ ì„±ëŠ¥ê°œì„  : ë² ì´ìŠ¤ë¼ì¸ë³´ë‹¤ ë‚˜ì€ ì„±ëŠ¥ì„ ëª©í‘œë¡œ ìµœì í™” ì§„í–‰

2 ì´ì •ë¦¬ :

1. íƒ€ê¹ƒê°’ë³€í™˜
    + íƒ€ê¹ƒê°’ì´ ì •ê·œë¶„í¬ì— ê°€ê¹Œìš¸ìˆ˜ë¡ íšŒê·€ë¬¸ì œì˜ ì„±ëŠ¥ì´ ì¢‹ë‹¤.
    + í•œìª½ìœ¼ë¡œ ì¹˜ìš°ì¹œ íƒ€ê¹ƒê°’ì€ ë¡œê·¸ë³€í™˜í•˜ë©´ ì •ê·œë¶„í¬ì— ê°€ê¹Œì›Œì§ , í›ˆë ¨í›„ ê²°ê³¼ê°’ì„ ì§€ìˆ˜ë³€í™˜í•˜ì—¬ ì›ë˜ íƒ€ê¹ƒí˜•íƒœë¡œ ë³µì›
<p>

1. ì´ìƒì¹˜ì œê±°
   + í›ˆë ¨ë°ì´í„°ì—ì„œ ì´ìƒì¹˜ ì œì„œì‹œ ì„±ëŠ¥ì´ í–¥ìƒë ìˆ˜ìˆìŒ
<p>
  

3. íŒŒìƒí”¼ì³ì¶”ê°€
   + ê¸°ì¡´í”¼ì³ë¥¼ ë¶„í•´,ì¡°í•©í•˜ì—¬ ìƒˆë¡œìš´ í”¼ì³ ìƒì„±ê°€ëŠ¥
<p>


4. íŒŒìƒí”¼ì³ì œê±°
   + ë¶ˆí•„ìš”í•œ í”¼ì³ ì œê±°ì‹œ í›ˆë ¨ì†ë„ ë° ì„±ëŠ¥ ê°œì„ 
<p>



5. ì„ í˜•íšŒê·€,ë¦¿ì§€,ë¼ì˜ ëª¨ë¸
   + ëŒ€í‘œ íšŒê·€ëª¨ë¸ì´ë‚˜, ë„ˆë¬´ ê¸°ë³¸ì´ë¼ ì„±ëŠ¥ì´ ë‚˜ì¨
<p>


6. ëœë¤ í¬ë ˆìŠ¤íŠ¸íšŒê·€
   + ì—¬ëŸ¬ëª¨ë¸ì„ ë¬¶ì–´ì‚¬ìš©, ëŒ€ì²´ë¡œ ê°„ë‹¨í•˜ê³  ì„±ëŠ¥ì´ ë‚˜ì˜ì§€ì•ŠìŒ
<p>


7. ê·¸ë¦¬ë“œì„œì¹˜
   + êµì°¨ê²€ì¦ìœ¼ë¡œ ìµœì ì˜ í•˜ì´í¼ íŒŒë¼ë¯¸í„°ë¥¼ ì°¾ì•„ì£¼ëŠ” ê¸°ë²•
<p>
